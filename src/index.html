<!DOCTYPE html>
<html lang="ja">
<head>

  <!-- Basic Page Needs
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <meta charset="utf-8">
  <title>今どっちでしょうか？</title>
  <meta name="description" content="">
  <meta name="atskae" content="">

  <!-- Mobile Specific Metas
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- FONT
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=M+PLUS+Rounded+1c&display=swap" rel="stylesheet">

  <!-- CSS
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <link rel="stylesheet" href="css/style.css">

  <!-- Favicon
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <link rel="icon" type="image/png" href="images/favicon.png">
</head>

<body>

  <!-- Primary Page Layout
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->

  <div id="overlay" onclick="removeOverlay()">
    <div id="overlay-text">遊ぼう！</div>
  </div>

  <div style="width: 45%; height: auto; margin: 0 auto;">

    <h1 style="text-align:center">今どっちでしょうか？</h1>

    <!-- Main Screen -->
    <div class="container">
      <img id="kobuchi-img" style="border:1px solid #c7c7c7; max-width:500px; height:auto; display:block; margin-left:auto; margin-right:auto;" src="images/placeholder_question.png">
    </div>
  
    <!-- Options 笑 -->
    <div class="container">
      <button class="button" id="have_it" onclick="buttonAction(this.id)" style="margin-right:1%; background-color: #90d145; border:2px solid #5a822b">持ってる</button>
      <button class="button" id="not_have_it" onclick="buttonAction(this.id)" style="background-color: #f0818d; border: 2px solid #822f40">持ってない</button>
    </div>
  
    <hr style="background-color:#c7c7c7; margin-top: 3%; margin-bottom: 3%; max-width: 10%">

    <!-- Score -->
    <div class="container">
      <div class="name-circle" style="background:white; color: black;">小</div> <span class="score" id="kobuchi-score" style="margin-right: 50%">0</span>
      <div class="name-circle" style="background:black; color: white;">黒</div> <span class="score">0</span>
    </div>

  </div> <!-- Main Container end -->
<!-- End Document
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->

<!-- Game logic
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <script>
    console.log("笑");

    // Images
    var questionImage = "images/placeholder_question.png";
    var haveItImage = "images/placeholder_have_it.png";
    var notHaveItImage = "images/placeholder_not_have_it.png";

    // Sound effects
    // Hopefully I won't get in trouble for this...
    var questionSound = new Audio('sounds/question.mp3');

    // Document elements
    kobuchiImage = document.getElementById("kobuchi-img")
    kobuchiScore = document.getElementById("kobuchi-score");

    function removeOverlay() {
      document.getElementById("overlay").style.display = "none";
      // Play main page audio
      questionSound.play();
    }

    function displayHaveIt() {
      console.log("displayHaveIt()");    
      kobuchiImage.src = haveItImage;
    }

    function displayNotHaveIt(){
      console.log("displayNotHaveIt()");
      kobuchiImage.src = notHaveItImage;
    }

    function disableButtons() {
      document.getElementById("have_it").setAttribute("disabled", true);
      document.getElementById("not_have_it").setAttribute("disabled", true);
      console.log("Buttons disabled.");
    }

    function enableButtons() {
      document.getElementById("have_it").removeAttribute("disabled");
      document.getElementById("not_have_it").removeAttribute("disabled");
      console.log("Buttons enabled.");
    }

    function returnToQuestion() {
      // Change to main image
      kobuchiImage.src = questionImage;
      
      // "Update" the score 笑
      score = parseInt(kobuchiScore.innerHTML);
      kobuchiScore.innerHTML = score + 1;

      // Ask question
      questionSound.play();

      // Enable buttons again
      enableButtons();
    }

    function buttonAction(choice) {
      console.log("choice=" + choice);
      
      // Disable buttons until animation and sound complete
      disableButtons();
      
      if (choice === "have_it") {
        displayNotHaveIt();
      }
      else if(choice === "not_have_it") {
        displayHaveIt();
      }
     
      // "Go-back" to main page
      setTimeout(returnToQuestion, 3000);
    }

    function main() {
      // Turn on overlay
      document.getElementById("overlay").style.display = "block";
    }

    main();

  </script>
</body>

</html>
